{
    "id": "417335b2-976e-441c-9653-3df6c732bab6",
    "name": "IF-UpdateClickOnce",
    "friendlyName": "Update a ClickOnce Package",
    "description": "Gives you the ability to modify some properties on a ClickOnce Package.",
    "author": "Peter Helje",
    "helpMarkDown": "",
    "category": "Utility",
    "visibility": [
      "Build",
      "Release"
    ],
    "demands": [],
    "version": {
      "Major": "0",
      "Minor": "1",
      "Patch": "14"
    },
    "minimumAgentVersion": "1.83.0",
    "instanceNameFormat": "Update ClickOnce Package",
    "groups": [
      {
          "name":"advanced",
          "displayName":"Advanced",
          "isExpanded":false
      }
    ],
    "inputs": [
      {
        "name": "ApplicationName",
        "type": "string",
        "label": "Application Name",
        "defaultValue": "",
        "required": true,
        "helpMarkDown": ""
      },
      {
        "name": "Publisher",
        "type": "string",
        "label": "Publisher",
        "defaultValue": "",
        "required": false,
        "helpMarkDown": ""
      },
      { 
        "name": "Certificate",
        "type": "filePath",
        "label": "Certificate file",
        "defaultValue": "",
        "required":true,
        "helpMarkDown": ""
      },
      { 
        "name": "CertificatePassword",
        "type": "string",
        "label": "Certificate Password",
        "defaultValue": "",
        "required":false,
        "helpMarkDown": "Certificate password if needed, You should use a secret variable here."
      },
      { 
        "name": "ProviderUrl",
        "type": "string",
        "label": "Provider Url",
        "defaultValue": "",
        "required":false,
        "helpMarkDown": ""
      },
      { 
        "name": "ApplicationFolder",
        "type": "filePath",
        "label": "Application folder",
        "defaultValue": "",
        "required":true,
        "helpMarkDown": ""
      },
      { 
        "name": "Version",
        "type": "string",
        "label": "ClickOnce Version",
        "defaultValue": "",
        "required": true,
        "helpMarkDown": "Set the version number of the ClickOnce package"
      },
      { 
        "name": "MinVersion",
        "type": "string",
        "label": "Minimum required version",
        "defaultValue": "",
        "required": false,
        "helpMarkDown": "Set the minimum required ClickOnce version, use %version% to use the version as minimum."
      },
      { 
          "name": "Advanced", 
          "type": "textbox", 
          "label": "Advanced XML modification", 
          "defaultValue":"", 
          "required":false,
          "helpMarkDown": "Here you can supply a JSON string that will be used to modify the specified node value in the .application file. The JSON file must have the following structure:{advanced: [{ElementPath: \"assembly.assemblyIdentity\",AttributeName: \"name\",AttributeValue: \"the new value\"}]}",
          "groupName":"advanced",
          "properties": {
            "resizable": "true",
            "rows": "15",
            "maxLength": "5000"
        }
      }
    ],
    "execution": {
      "PowerShell": {
        "target": "$(currentDirectory)\\Update-ClickOnce.ps1",
        "argumentFormat": "",
        "workingDirectory": "$(currentDirectory)"
      }
    }
  }