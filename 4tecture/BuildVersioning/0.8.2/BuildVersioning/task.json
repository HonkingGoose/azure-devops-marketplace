{
    "id": "9e3e2353-692f-4804-9fc1-8a3bca551511",
    "name": "BuildVersioning",
    "friendlyName": "Build Versioning",
    "description": "Task to version build artifacts.",
    "helpMarkDown": "[More Information](https://github.com/4tecture/BuildVersioning)",
    "category": "Build",
    "visibility": [
        "Build"
    ],
    "author": "",
    "version": {
        "Major": 0,
        "Minor": 8,
        "Patch": 2
    },
    "demands": [],
    "groups": [
        {
            "name": "grpGeneralVersionInfo",
            "displayName": "General Versioning Information",
            "isExpanded": true
        },
        {
            "name": "grpAssemblyVersioning",
            "displayName": ".NET Assembly Versions",
            "isExpanded": true
        },
        {
            "name": "grpNuspecVersioning",
            "displayName": "Nuspec Versioning",
            "isExpanded": true
        },
        {
            "name": "grpNpmVersioning",
            "displayName": "Npm Versioning",
            "isExpanded": true
        },
        {
            "name": "grpdotNetCoreVersioning",
            "displayName": ".NET Core Versioning",
            "isExpanded": true
        },
        {
            "name": "grpAndroidVersioning",
            "displayName": "Android Versioning",
            "isExpanded": true
        },
        {
            "name": "grpiOSVersioning",
            "displayName": "iOS Versioning",
            "isExpanded": true
        },
        {
            "name": "grpCustomVersioning",
            "displayName": "Custom Versioning",
            "isExpanded": true
        },
        {
            "name": "grpAdvancedSettings",
            "displayName": "Advanced Settings",
            "isExpanded": true
        }
        
    ],
    "inputs": [
        {
            "name": "sourcePath",
            "type": "filePath",
            "label": "Source Path",
            "defaultValue": "",
            "required": false,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Path in which to search for version files (like AssemblyInfo.* files). Leave empty to use the sources directory. NOTE: this is case sensitive for non-Windows systems."
        },
        {
            "name": "versionSource",
            "type": "pickList",
            "label": "Version Source",
            "defaultValue": "buildNumber",
            "options": {
                "buildNumber": "Build Number",
                "variable": "Variable",
                "gitversion": "GitVersion"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "The source for the version number. Defaults to the build number, but can be a build variable."
        },
        {
            "name": "doInstallGitVersion",
            "type": "boolean",
            "label": "Install Git Version if not present or older",
            "defaultValue": "true",
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Check this option if you want to install GitVersion.",
            "visibleRule": "versionSource=gitversion"
        },
        {
            "name": "GitVersionInstallerUrl",
            "type": "string",
            "label": "Installer Url for Git Version",
            "defaultValue": "https://github.com/GitTools/GitVersion/releases/download/v4.0.0-beta.13/GitVersion_4.0.0-beta0013.zip",
            "required": false,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Provide a Url to the Zip for installation",
            "visibleRule": "doInstallGitVersion=true"
        },
        {
            "name": "customNumberVariable",
            "type": "string",
            "label": "Variable to use",
            "defaultValue": "myBuildNumber",
            "required": false,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Variable to use for the version number. Do not specify $() - just enter the name.",
            "visibleRule": "versionSource=variable"
        },
        {
            "name": "versionFormat",
            "type": "pickList",
            "label": "Version Extract Pattern",
            "defaultValue": "fourParts",
            "options": {
                "fourParts": "X.X.X.X",
                "threeParts": "X.X.X",
                "custom": "Custom Regex"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Pattern to use to extract the build number as well as default replacement pattern.",
            "visibleRule": "versionSource=buildNumber"
        },
        {
            "name": "customBuildRegex",
            "type": "string",
            "label": "Custom Regex Find Pattern",
            "defaultValue": "\\d+\\.\\d+\\.\\d+\\.\\d+",
            "required": false,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Regular Expression to extract version from build number. This is also the default replace regex (unless otherwise specified in Advanced settings).",
            "visibleRule": "versionFormat=custom"
        },
        {
            "name": "buildRegexIndex",
            "type": "string",
            "label": "Build Regex Group Index",
            "defaultValue": "0",
            "required": false,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Index of group in build regular expression that you want to use as the version number. Leave as 0 if you have no groups.",
            "visibleRule": "versionFormat=custom"
        },
        {
            "name": "paramAssemblyVersion",
            "type": "pickList",
            "label": "Digits used for Assembly Version",
            "defaultValue": "4",
            "options": {
                "1": "X.0.0.0",
                "2": "X.X.0.0",
                "3": "X.X.X.0",
                "4": "X.X.X.X",
                "5": "X.X.X.<CommitsSinceVersion> (GitVersion)",
                "7": "<AssemblySemVer> (GitVersion)"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Define how many digits will be used for the assembly version. Unused digits will be set to 0."
        },
        {
            "name": "paramAssemblyFileVersion",
            "type": "pickList",
            "label": "Digits used for Assembly File Version",
            "defaultValue": "4",
            "options": {
                "1": "X.0.0.0",
                "2": "X.X.0.0",
                "3": "X.X.X.0",
                "4": "X.X.X.X",
                "5": "X.X.X.<CommitsSinceVersion> (GitVersion)",
                "7": "<AssemblySemVer> (GitVersion)"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Define how many digits will be used for the assembly file version. Unused digits will be set to 0."
        },
        {
            "name": "paramAssemblyInformationalVersion",
            "type": "pickList",
            "label": "Digits used for Assembly Informational Version",
            "defaultValue": "4",
            "options": {
                "1": "X.0.0.0",
                "2": "X.X.0.0",
                "3": "X.X.X.0",
                "4": "X.X.X.X",
                "5": "X.X.X.<CommitsSinceVersion> (GitVersion)",
                "6": "<SemVer> (GitVersion)"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Define how many digits will be used for the assembly informational version. Unused digits will be set to 0."
        },
        {
            "name": "doAssemblyInfoAppendSuffix",
            "type": "boolean",
            "label": "Append suffix to Assembly Info Version",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Check this option if you want to append the suffix to the assembly info version."
        },
        {
            "name": "paramAssemblyInfoSuffixType",
            "type": "pickList",
            "label": "Suffix Type",
            "defaultValue": "4",
            "options": {
                "1": "fixed Value",
                "2": "branch name",
                "3": "PreReleaseLabel (GitVersion)",
                "4": "FullBuildMetadata (GitVersion)"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Define how many digits will be used for the assembly informational version. Unused digits will be set to 0.",
            "visibleRule": "doAssemblyInfoAppendSuffix=true"
        },
        {
            "name": "paramAssemblyInformationalVersionSuffix",
            "type": "string",
            "label": "Suffix for Assembly Informational Version",
            "defaultValue": "",
            "required": false,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Add a suffix after the version string for the assembly inforamtional version.",
            "visibleRule": "doAssemblyInfoAppendSuffix=true && paramAssemblyInfoSuffixType=1"
        },
        {
            "name": "buildNumberVersionFormat",
            "type": "pickList",
            "label": "Build Number Version Format",
            "defaultValue": "3",
            "options": {
                "1": "AssemblyVersion",
                "2": "AssemblyFileVersion",
                "3": "AssemblyInformationalVersion"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Choose the version format to be used as build number."
        },
        {
            "name": "buildNumberAction",
            "type": "pickList",
            "label": "Build Number Action",
            "defaultValue": "nothing",
            "options": {
                "nothing": "Do nothing",
                "append": "Append",
                "replace": "Replace"
            },
            "required": true,
            "groupName" : "grpGeneralVersionInfo",
            "helpMarkDown": "Choose to replace the build number or append the verion information"
        },
        {
            "name": "doReplaceAssemblyInfo",
            "type": "boolean",
            "label": "Do replace in AssemblyInfo files.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpAssemblyVersioning",
            "helpMarkDown": "Check this option if you want to replace the version definition in Assembly Info files."
        },
        {
            "name": "filePatternAssemblyInfo",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\AssemblyInfo.*",
            "required": true,
            "helpMarkDown": "File filter to replace version info.",
            "groupName" : "grpAssemblyVersioning",
            "visibleRule": "doReplaceAssemblyInfo=true"
        },
        {
            "name": "doReplaceNuspec",
            "type": "boolean",
            "label": "Do replace in Nuspec files.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpNuspecVersioning",
            "helpMarkDown": "Check this option if you want to replace the version definition in Nuspec files."
        },
        {
            "name": "filePatternNuspec",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\*.nuspec",
            "required": true,
            "groupName" : "grpNuspecVersioning",
            "helpMarkDown": "File filter to replace version info.",
            "visibleRule": "doReplaceNuspec=true"
        },
        {
            "name": "paramNuspecVersionType",
            "type": "pickList",
            "label": "Use Version",
            "defaultValue": "2",
            "options": {
                "1": "AssemblyVersion",
                "2": "AssemblyFileVersion",
                "3": "AssemblyInformationalVersion"
            },
            "required": true,
            "groupName" : "grpNuspecVersioning",
            "helpMarkDown": "Which version should be used for nuspec package versioning",
            "visibleRule": "doReplaceNuspec=true"
        },
        {
            "name": "doNuspecUpdateDepencency",
            "type": "boolean",
            "label": "Do replace version information in package dependencies",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpNuspecVersioning",
            "helpMarkDown": "Check this option if you want to replace the version of dependent packages in the nuspec files.",
            "visibleRule": "doReplaceNuspec=true"
        },
        {
            "name": "nuspecDependencyPackageName",
            "type": "string",
            "label": "Update Dependency Package Name",
            "defaultValue": "",
            "required": false,
            "groupName" : "grpNuspecVersioning",
            "helpMarkDown": "Package name (fragment) of dependencies which should be updated to the current build number.",
            "visibleRule": "doNuspecUpdateDepencency=true"
        },
        {
            "name": "doReplaceNpm",
            "type": "boolean",
            "label": "Do replace in npm packages.json files.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpNpmVersioning",
            "helpMarkDown": "Check this option if you want to replace the version definition in npm package.json files."
        },
        {
            "name": "filePatternNpm",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\package.json",
            "required": true,
            "groupName" : "grpNpmVersioning",
            "helpMarkDown": "File filter to replace version info.",
            "visibleRule": "doReplaceNpm=true"
        },
        {
            "name": "paramNpmVersionType",
            "type": "pickList",
            "label": "Use Version for Package Version",
            "defaultValue": "1",
            "options": {
                "1": "Version (3 digits)",
                "2": "SemVer (GitVersion)"
            },
            "required": true,
            "groupName" : "grpNpmVersioning",
            "helpMarkDown": "Which version should be used for npm package versioning",
            "visibleRule": "doReplaceNpm=true"
        },
        {
            "name": "doReplaceDotNetCore",
            "type": "boolean",
            "label": "Do replace in .NET Core project files.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpdotNetCoreVersioning",
            "helpMarkDown": "Check this option if you want to replace the version definition in .NET Core project files."
        },
        {
            "name": "filePatternDotNetCore",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\*.csproj",
            "required": true,
            "groupName" : "grpdotNetCoreVersioning",
            "helpMarkDown": "File filter to replace version info.",
            "visibleRule": "doReplaceDotNetCore=true"
        },
        {
            "name": "paramDotNetCoreVersionType",
            "type": "pickList",
            "label": "Use Version for Package Version",
            "defaultValue": "3",
            "options": {
                "1": "AssemblyVersion",
                "2": "AssemblyFileVersion",
                "3": "AssemblyInformationalVersion"
            },
            "required": true,
            "groupName" : "grpdotNetCoreVersioning",
            "helpMarkDown": "Which version should be used for .NET Core package versioning",
            "visibleRule": "doReplaceDotNetCore=true"
        },
        {
            "name": "doReplaceAndroid",
            "type": "boolean",
            "label": "Do replace in Android project files.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpAndroidVersioning",
            "helpMarkDown": "Check this option if you want to replace the version definition in Android project files."
        },
        {
            "name": "filePatternAndroid",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\AndroidManifest.xml",
            "required": true,
            "groupName" : "grpAndroidVersioning",
            "helpMarkDown": "File filter to replace version info.",
            "visibleRule": "doReplaceAndroid=true"
        },
        {
            "name": "doReplaceiOS",
            "type": "boolean",
            "label": "Do replace in iOS project files.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpiOSVersioning",
            "helpMarkDown": "Check this option if you want to replace the version definition in iOS project files."
        },
        {
            "name": "filePatterniOS",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\Info.plist",
            "required": true,
            "groupName" : "grpiOSVersioning",
            "helpMarkDown": "File filter to replace version info.",
            "visibleRule": "doReplaceiOS=true"
        },


        {
            "name": "doReplaceCustom",
            "type": "boolean",
            "label": "Do replace version with custom regex.",
            "defaultValue": "false",
            "required": true,
            "groupName" : "grpCustomVersioning",
            "helpMarkDown": "Check this option if you want to replace the versions in a custom manner."
        },
        {
            "name": "filePatternCustom",
            "type": "string",
            "label": "File Pattern",
            "defaultValue": "**\\<myfilepattern>",
            "required": true,
            "groupName" : "grpCustomVersioning",
            "helpMarkDown": "File filter to replace version info.",
            "visibleRule": "doReplaceCustom=true"
        },
        {
            "name": "paramCustomSearchRegex",
            "type": "string",
            "label": "Search Regex",
            "defaultValue": "(<AssemblyVersion>)(\\d+\\.\\d+\\.\\d+(?:\\.\\d+)?)(</AssemblyVersion>)",
            "required": true,
            "groupName" : "grpCustomVersioning",
            "helpMarkDown": "Regex to search for the version to be replaced",
            "visibleRule": "doReplaceCustom=true"
        },
        {
            "name": "paramCustomReplaceRegex",
            "type": "string",
            "label": "Replace Regex",
            "defaultValue": "$1$(BuildVersion.Version)$3",
            "required": true,
            "groupName" : "grpCustomVersioning",
            "helpMarkDown": "Regex to replace the value found by the search regex.",
            "visibleRule": "doReplaceCustom=true"
        },
        {
            "name": "doShowWarningsForUnmatchedRegex",
            "type": "boolean",
            "label": "Show warnings for unmatched regex",
            "defaultValue": "true",
            "required": true,
            "groupName" : "grpAdvancedSettings",
            "helpMarkDown": "Check this option if you want to see warnings if regex definitions are not matched in the desired files."
        }
    ],
    "instanceNameFormat": "BuildVersioning",
    "execution": {
        "Node": {
            "target": "BuildVersioning.js"
        }
    }
}