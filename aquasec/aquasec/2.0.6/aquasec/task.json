{
    "id": "53872c9a-a53f-4fcf-973d-8ded3d75432c",
    "name": "aquasecScanner",
    "friendlyName": "Aqua Security",
    "description": "Security Assessment for Images",
    "author": "aquasec",
    "helpMarkDown": "This task scans a Docker image for security vulnerabilities and compare it against an image assurance policy. You should add this task after a step that builds a Docker image and before a step that pushes the image to a registry.",
    "category": "Build",
    "visibility": [
        "Build",
        "Release"
    ],
    "demands": [
        "sh"
    ],
    "version": {
        "Major": "0",
        "Minor": "2",
        "Patch": "18"
    },
    "minimumAgentVersion": "1.95.0",
    "instanceNameFormat": "Image Scanning",
    "groups": [
        {
            "name": "advanced",
            "displayName": "Advanced",
            "isExpanded": false
        }
    ],
    "inputs": [
        {
          "name": "image",
          "type": "string",
          "label": "Image Name",
          "defaultValue": "",
          "required": true,
          "helpMarkDown": "The image to scan. Can be a static name, e.g. myapp/myimage:4, or a variable based name, e.g. $(Build.Repository.Name):$(Build.BuildId)"
        },
        {
          "name": "connection",
          "type": "connectedService:Generic",
          "label": "Aqua Management Console Connection",
          "defaultValue": "",
          "required": true,
          "helpMarkDown": "The Aqua Management Console connection. click the Manage link and create a new Generic Service Endpoint, enter the Aqua Management Console url, e.g. <b>`https://server.example.com`</b>, and required credentials."
        },
        {
          "name": "scanner",
          "type": "string",
          "label": "Aqua Scanner-CLI Image Name",
          "defaultValue": "aquasec/scanner-cli:2.0",
          "required": true,
          "helpMarkDown": "Change this field to use a non default version of the Aqua Scanner."
        },
        {
          "name": "dockerurl",
          "type": "string",
          "label": "Docker Host Connection",
          "defaultValue": "/var/run/docker.sock",
          "required": false,
          "helpMarkDown": "The Docker Host Connection.",
          "groupName":  "advanced"
        }
    ],
    "execution": {
        "Node": {
          "target": "dockerTask.js",
          "argumentFormat": ""
        }
    },
    "messages": {
        "ScanReturnCode": "scan exited with return code: %d",
        "ScanFailed": "scan failed with error: %s"
    }
}
