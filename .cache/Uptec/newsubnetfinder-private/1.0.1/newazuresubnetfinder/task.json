{"$schema":"https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json","id":"d542008e-5d62-436f-b97a-be675137801f","name":"NewAzureSubnetFinder","friendlyName":"New Azure Subnet Finder","description":"Calculates next available subnet in Azure Virtual Network","helpMarkDown":"https://github.com/uptecio/New-Subnet-Finder","category":"Build","author":"Rodney Almeida (Uptec)","version":{"Major":0,"Minor":1,"Patch":"1"},"inputs":[{"name":"ConnectedServiceNameARM","type":"connectedService:AzureRM","label":"Azure Subscription","defaultValue":"","required":true,"helpMarkDown":"Azure Resource Manager subscription to configure before running PowerShell"},{"name":"ResourceGroupName","label":"Resource Group","type":"pickList","required":true,"helpMarkDown":"Select resource group which contains the virtual network","properties":{"EditableOptions":"True"}},{"name":"VirtualNetworkName","type":"pickList","label":"Virtual Network","required":true,"helpMarkDown":"The Virtual Network you want to check against","properties":{"EditableOptions":"True"}},{"name":"VirtualNetworkAddressSpace","type":"pickList","label":"Virtual Network Address Space","helpMarkDown":"The Virtual Network Address Space you want to check against. If left empty, the first address space of the virtual network will be assumed","properties":{"EditableOptions":"True"}},{"name":"NewSubnetSize","type":"string","label":"Mask bit of new subnet","defaultValue":"","required":true,"helpMarkDown":"28"},{"name":"CreateSubnet","type":"boolean","label":"Create Subnet","helpMarkDown":"Create Subnet if space if found"},{"name":"NewSubnetName","type":"string","label":"Name of new subnet to be created","defaultValue":"mysubnet","required":true,"helpMarkDown":"mysubnet","visibleRule":"CreateSubnet = true"},{"name":"OutputVariableName","type":"string","label":"Name of the Output Variable to set new subnets CIDR","defaultValue":"","required":true,"helpMarkDown":"mynewsubnet"}],"dataSourceBindings":[{"target":"ResourceGroupName","endpointId":"$(ConnectedServiceNameARM)","dataSourceName":"AzureResourceGroups"},{"name":"VirtualNetworks","target":"VirtualNetworkName","endpointId":"$(ConnectedServiceNameARM)","endpointUrl":"{{endpoint.url}}/subscriptions/{{endpoint.subscriptionId}}/resourceGroups/$(ResourceGroupName)/providers/Microsoft.Network/virtualNetworks?api-version=2020-11-01","resultSelector":"jsonpath:$.value[*].name","parameters":{"ResourceGroupName":"$(ResourceGroupName)"}},{"name":"VirtualNetworkAddressSpaces","target":"VirtualNetworkAddressSpace","endpointId":"$(ConnectedServiceNameARM)","endpointUrl":"{{endpoint.url}}/subscriptions/{{endpoint.subscriptionId}}/resourceGroups/$(ResourceGroupName)/providers/Microsoft.Network/virtualNetworks/$(VirtualNetworkName)?api-version=2020-11-01","resultSelector":"jsonpath:$.properties.addressSpace.addressPrefixes[*]","parameters":{"ResourceGroupName":"$(ResourceGroupName)","VirtualNetworkName":"$(VirtualNetworkName)"}}],"execution":{"PowerShell3":{"target":"NewAzureSubnetFinder.ps1"}}}
