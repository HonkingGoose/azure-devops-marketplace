{
    "id": "53872c9a-a53f-4fcf-973d-8ded3d75432c",
    "name": "aquasecScanner",
    "friendlyName": "Aqua Security",
    "description": "Aqua Security vulnerabilities scanner for Docker images",
    "author": "aquasec",
    "helpMarkDown": "Adds a Build Step for scanning Docker images for security vulnerabilities, using the API provided by Aqua Security.",
    "category": "Build",
    "visibility": [
        "Build",
        "Release"
    ],
    "demands": [
        "sh"
    ],
    "version": {
        "Major": "0",
        "Minor": "2",
        "Patch": "0"
    },
    "minimumAgentVersion": "1.95.0",
    "instanceNameFormat": "Aqua Security vulnerabilities scanner for Docker images",
    "groups": [
        {
            "name": "advanced",
            "displayName": "Advanced",
            "isExpanded": false
        }
    ],
    "inputs": [
        {
          "name": "image",
          "type": "string",
          "label": "Image Name",
          "defaultValue": "",
          "required": true,
          "helpMarkDown": "The image you want to scan"
        },
        {
          "name": "connection",
          "type": "connectedService:Generic",
          "label": "Aqua management console Connection",
          "defaultValue": "",
          "required": true,
          "helpMarkDown": "The aqua management console connection. click the Manage link and create a new Generic Service Endpoint, enter the Aqua management console url, e.g. <b>`https://server.example.com`</b>, and required credentials."
        },
        {
          "name": "scanner",
          "type": "string",
          "label": "Aqua Scanner-cli image name",
          "defaultValue": "aquasec/scanner-cli:1.4",
          "required": true,
          "helpMarkDown": "The aqua scanner-cli image name."
        },
        {
          "name": "dockerurl",
          "type": "string",
          "label": "Docker Host Connection",
          "defaultValue": "/var/run/docker.sock",
          "required": false,
          "helpMarkDown": "The Docker Host Connection.",
          "groupName":  "advanced"
        }
    ],
    "execution": {
        "Node": {
          "target": "dockerTask.js",
          "argumentFormat": ""
        }
    },
    "messages": {
        "ScanReturnCode": "scan exited with return code: %d",
        "ScanFailed": "scan failed with error: %s"
    }
}
