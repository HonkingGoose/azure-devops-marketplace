{
	"id": "95170664-b64e-4571-9cd4-936b3a626292",
	"name": "nventiveCanaryUpdater",
	"friendlyName": "Canary Updater",
	"description": "A task to update a Canary build.",
	"helpMarkDown": "[nventive](http://www.nventive.com/)",
	"category": "Build",
	"author": "nventive",
	"version": {
		"Major": 2,
		"Minor": 5,
		"Patch": 214
	},
	"visibility": [
		"Build"
	],
	"demands": [
		"msbuild"
	],
	"instanceNameFormat": "Canary Update",
	"groups": [
		{
			"name": "rebase",
			"displayName": "Rebase Source",
			"isExpanded": true
		},
		{
			"name": "nuget",
			"displayName": "Nuget Update",
			"isExpanded": true
		},
		{
			"name": "more",
			"displayName": "Additional Options",
			"isExpanded": true
		}
	],
	"inputs": [
		{
			"name": "targetBranch",
			"type": "string",
			"label": "Target Branch",
			"groupName": "rebase",
			"defaultValue": "origin/master",
			"required": true,
			"helpMarkDown": "The target branch of the rebase",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "nugetFeed",
			"type": "pickList",
			"label": "Source Feed",
			"groupName": "nuget",
			"defaultValue": "",
			"required": true,
			"helpMarkDown": "The feed from which to update packages",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "nugetVersion",
			"type": "string",
			"label": "Special Version",
			"groupName": "nuget",
			"defaultValue": "dev",
			"required": false,
			"helpMarkDown": "The special version to update packages to",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "excludeTag",
			"type": "string",
			"label": "Tag to exclude",
			"groupName": "nuget",
			"defaultValue": "",
			"required": false,
			"helpMarkDown": "Exclude versions with this tag in the NuGet update",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "allowDowngrade",
			"type": "boolean",
			"label": "Allow downgrade",
			"groupName": "nuget",
			"defaultValue": false,
			"required": false,
			"helpMarkDown": "Indicates whether the packages can be downgraded if the matching version is lower",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "ignorePackages",
			"type": "string",
			"label": "Ignore Packages",
			"groupName": "nuget",
			"defaultValue": "",
			"required": false,
			"helpMarkDown": "Indicates which packages (separated by ';') to exclude from the update",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "gitUserName",
			"type": "string",
			"label": "Git user name",
			"groupName": "more",
			"required": false,
			"helpMarkDown": "The email for Git to use when executing operations.",
		},
		{
			"name": "gitUserEmail",
			"type": "string",
			"label": "Git user email",
			"groupName": "more",
			"required": false,
			"helpMarkDown": "The name for Git to use when executing operations.",
		},
		{
			"name": "pushBranch",
			"type": "boolean",
			"label": "Push updated branch",
			"groupName": "more",
			"defaultValue": false,
			"required": false,
			"helpMarkDown": "Push the updated branch to the repository. The build service must be given the right to contribute and create branches in the repository.",
			"properties": {
				"DisableManageLink": "True"
			}
		},
		{
			"name": "branchName",
			"type": "string",
			"label": "Branch name",
			"groupName": "more",
			"defaultValue": "canaries/$(Build.BuildId)",
			"required": false,
			"helpMarkDown": "The target branch name.",
			"visibleRule" : "pushBranch == true",
			"properties": {
				"DisableManageLink": "True"
			}
		}
	],
	"dataSourceBindings": [
		{
			"target": "nugetFeed",
			"endpointId": "tfs:feed",
			"endpointUrl": "{{endpoint.url}}/_apis/packaging/feeds",
			"resultSelector": "jsonpath:$.value[*]",
			"resultTemplate": "{ \"Value\" : \"{{{url}}}\", \"DisplayValue\" : \"{{{name}}}\" }"
		}
	],
	"sourceDefinitions": [
	],
	"execution": 
	{
		"Node": {
			"target": "task.js"
		}
	},
	"dependencies" :
	{
		"vsts-task-lib": "^2.0.5"
	}
}
