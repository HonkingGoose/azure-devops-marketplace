{
    "id": "DC86E5F9-18E2-492B-8D35-588E526AA3B1",
    "name": "CosmosDBCollectionManagement",
    "friendlyName": "Cosmos DB Collection Management",
    "description": "With the Azure Cosmos DB Collection Management, you can easily create/delete or update Azure Cosmos DB Collections",
    "author": "Winvision BV",
    "helpMarkDown": "[Support](https://github.com/Winvision/vsts-tasks)",
    "category": "Utility",
    "visibility": [
        "Build",
        "Release"
    ],
    "runsOn": ["Agent"],
    "version": {
        "Major": 0,
        "Minor": 1,
        "Patch": 0
    },
    "minimumAgentVersion": "1.83.0",
    "instanceNameFormat": "Cosmos DB Collection Management",
    "groups": [
    ],
    "inputs": [
        {
            "name": "actionType",
            "type": "pickList",
            "label": "Action",
            "defaultValue": "create",
            "options": {
				"create": "Create collection",
                "delete": "Delete collection",
                "update": "Update collection"
			},
            "required": true,
            "helpMarkDown": "Action to be performed",
            "properties": {
                "EditableOptions": "False"
            }
        },
        {
            "name": "cosmosDBConnectionstring",
            "type": "string",
            "label": "ConnectionString",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Connection string (example: \"AccountEndpoint=xyz;AccountKey=xyz;Database=xyz\")"
        },
        {
            "name": "cosmosDBCollection",
            "type": "string",
            "label": "Collection",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Regex pattern to match one or more documents collection names"
        },
        {
            "name": "cosmosDBCollectionThroughput",
            "type": "string",
            "label": "Collection Throughput",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Optional, default is 1000. Specifies maximum throughput of the collection",
            "visibleRule": "actionType != delete"
        },
        {
            "name": "cosmosDBPartitionKey",
            "type": "string",
            "label": "PartitionKey",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Optional. Path to the property to use as hash partitioning key (example: \"/deviceId\")",
            "visibleRule": "actionType = create"
        },
        {
            "name": "cosmosDBIndexingPolicyType",
            "type": "radio",
            "label": "Query type",
            "defaultValue": "inline",
            "options": {
                "inline" : "Enter Indexing Policy",
                "filePath" : "Select Policy File"
            },
            "required": true,
            "helpMarkDown": "Indexing policy type: File path or inline",
            "visibleRule": "actionType != delete",
            "properties": {
                "EditableOptions": "False"
            }
        },
        {
            "name": "cosmosDBIndexingPolicy",
            "type": "multiLine",
            "label": "Indexing Policy",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Optional. Indexing policy for the collection",
            "visibleRule": "actionType != delete && cosmosDBIndexingPolicyType = inline"
        },
        {
            "name": "cosmosDBIndexingPolicyFile",
            "type": "filePath",
            "label": "Indexing Policy File",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Optional. Path to the file containing indexing policy for the collection",
            "visibleRule": "actionType != delete && cosmosDBIndexingPolicyType = filePath"
        }
    ],
    "execution": {
        "Node": {
            "target": "index.js"
        }
    },
    "messages": {}
}