{
    "id": "a125d483-91fe-47f9-ba21-90a544e950f1",
    "name": "Export Portal Configuration",
    "friendlyName": "Export Portal Configuration",
    "description": "This task will export portal configuration to Azure Repos",
    "author": "Arpit",
    "helpMarkDown": "Replace with markdown to show in help",
    "category": "Utility",
    "visibility": [
      "Build",
      "Release"
    ],
    "demands": [],
    "version": {
      "Major": "1",
      "Minor": "1",
      "Patch": "56"
    },
    "minimumAgentVersion": "1.95.0",
    "instanceNameFormat": "Export Portal Configuration $(message)",

    "inputs": [
      {
        "name": "D365URL",
        "type": "string",
        "label": "Dynamics 365 URL",
        "defaultValue": "",
        "required": true,
        "helpMarkDown": "For Ex: https://<orgname>.crm11.dynamics.com"
    },
    {
      "name": "PortalWebsiteid",
      "type": "string",
      "label": "Website Id",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "You can capture this value from Dynamics 365"
  },
      {
          "name": "ApplicationId",
          "type": "string",
          "label": "Application Id",
          "defaultValue": "",
          "required": true,
          "helpMarkDown": "You can capture this value while doing app registration in Azure AD"
      },
      {
        "name": "ClientSecret",
        "type": "string",
        "label": "Client Secret",
        "defaultValue": "",
        "required": true,
        "helpMarkDown": "You can capture this value while doing app registration in Azure AD"
    },
    {
      "name": "TenantId",
      "type": "string",
      "label": "Tenant Id",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "You can capture this value from Azure AD"
  },
  {
    "name": "TargetFolderAll",
    "type": "filePath",
    "label": "Save export data (All)",
    "defaultValue": "",
    "required": true,
    "helpMarkDown": "Choose Folder path, where you want to save the whole portal data export"
},
{
  "name": "TargetFolderSelected",
  "type": "filePath",
  "label": "Save export data (Selected)",
  "defaultValue": "",
  "required": false,
  "helpMarkDown": "Folder where you want to store, only selected tables portal data export"
},
{
  "name": "ExcludeTables",
  "type": "string",
  "label": "Exclude data",
  "defaultValue": "",
  "required": false,
  "helpMarkDown": "Mention table/file name (in comma seperated format) that you don't want to include in your portal deployment. Syntax:: web-pages,web-templates,sitesetting.yml"
}
  ],
  "OutputVariables": [
    {
        "name": "ExcludedTables",
        "description": "This sends the excluded table list to the next step of the pipeline."
    }
],
   
    "execution": {
      "PowerShell3": {
        "target": "sample1.ps1"
      }
    }
  }