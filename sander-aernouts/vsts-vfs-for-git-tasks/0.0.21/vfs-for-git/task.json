{
   "id": "08303e1c-e498-484c-a908-708604ddaefa",
   "name": "vfs-for-git",
   "friendlyName": "VFS for git",
   "description": "Interact with VFS for git",
   "helpMarkDown": "[More Information](https://url.to/yourmarkdown)",
   "category": "Utility",
   "visibility": ["Build","Release"],
   "author": "",
   "version": {
      "Major": 0,
      "Minor": 0,
      "Patch": 14
   },
   "demands": [],
   "inputs": [
        {
            "name": "projectId",
            "type": "picklist",
            "label": "Project",
            "defaultValue": "",
            "properties": {
                "EditableOptions": "True",
                "DisableManageLink": "True"
            },
            "required": true,
            "helpMarkDown": "Project that contains the git repository you want to clone."
        },
        {
            "name": "gitRepositoryId",
            "type": "picklist",
            "label": "Repository",
            "defaultValue": "","properties": {
                "EditableOptions": "True",
                "DisableManageLink": "True"
            }            ,
            "required": true,
            "helpMarkDown": "Git repository you want to clone using VFS for git"
        },
        {
            "name": "enlistmentRootPath",
            "type": "string",
            "label": "Destination directory",
            "defaultValue": "$(System.SourcesDirectory)",
            "required": true,
            "helpMarkDown": "Directory where the git repository will be cloned to using VFS for git. Note that VFS for git uses a special folder structure for Enlistments (repositories clone using VFS for git). The contens of your repository will be placed in a `/src` subfolder. For example `$(Build.SourcesDirectory)/<repositoryname>/src`."
        }
        
   ],
   "dataSourceBindings": [
        {
            "endpointId": "tfs:teamfoundation",
            "target": "projectId",
            "endpointUrl": "{{endpoint.url}}/_apis/projects?$skip={{skip}}&$top=1000",
            "resultSelector": "jsonpath:$.value[?(@.state=='wellFormed')]",
            "resultTemplate": "{ \"Value\" : \"{{{id}}}\", \"DisplayValue\" : \"{{{name}}}\" }",
            "callbackContextTemplate": "{\"skip\": \"{{add skip 1000}}\"}",
            "callbackRequiredTemplate": "{{isEqualNumber result.count 1000}}",
            "initialContextTemplate": "{\"skip\": \"0\"}"
          },
          {
            "endpointId": "tfs:teamfoundation",
            "target": "gitRepositoryId",
            "endpointUrl": "{{endpoint.url}}/{{project}}/_apis/git/repositories",
            "resultSelector": "jsonpath:$.value[*]",
            "parameters": {
                "project": "$(projectId)"
            },
            "resultTemplate": "{ \"Value\" : \"{{{id}}}\", \"DisplayValue\" : \"{{{name}}}\" }"
      }

    ],
   "instanceNameFormat": "vfs-for-git",
   "execution":
    {"Node":{"target":"vfs-for-git.js"}}
   
}