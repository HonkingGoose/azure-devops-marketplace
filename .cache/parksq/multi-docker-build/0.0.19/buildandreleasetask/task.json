{
    "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
    "id": "0a3b12a2-9178-482b-9bf3-ff9af4ce9a3c",
    "name": "multiDockerBuild",
    "friendlyName": "Multi Docker Build",
    "description": "Build multiple docker images from any number of dockefiles in your code repo. Configurable dockerfile paths, image names and tags.",
	"helpUrl": "https://www.parksq.co.uk/azure-dev-ops/multi-docker-build",
	"helpMarkDown": "[Learn more about this task](https://www.parksq.co.uk/azure-dev-ops/multi-docker-build-extension)",
    "category": "Azure Pipelines",
	"visibility": [
        "Build",
        "Release"
    ],
    "author": "Park Square Consulting Ltd",
    "version": {
        "Major": 0,
        "Minor": 0,
        "Patch": 19
    },
    "instanceNameFormat": "Multi Docker Build $(configPath)",
	"groups": [
        {
            "name": "containerRepository",
            "displayName": "Container Repository",
            "isExpanded": true
        },
        {
            "name": "command",
            "displayName": "Command",
            "isExpanded": true
        }
    ],
    "inputs": [
		{
            "name": "registryUrl",
            "type": "string",
            "label": "Registry URL",
            "required": true,
            "helpMarkDown": "Container registry URL",
			"groupName": "containerRepository"
		},
		{
            "name": "registryUsername",
            "type": "string",
            "label": "Username",
            "required": true,
            "helpMarkDown": "Username to log into registry with",
			"groupName": "containerRepository"
		},
		{
            "name": "registryPassword",
            "type": "string",
            "label": "Password",
            "required": true,
            "helpMarkDown": "Password to log into registry with",
			"groupName": "containerRepository"
		},
		{
            "name": "repositoryName",
            "type": "string",
            "label": "Repository Name",
            "required": true,
            "helpMarkDown": "Repository name, e.g. for foo.bar.com/myrepo/yourimage:sometag enter 'myrepo' here",
			"groupName": "containerRepository"
		},
        {
            "name": "configPath",
            "type": "filePath",
            "label": "Configuration File Path",
            "defaultValue": "docker-build-config.json",
            "required": true,
            "helpMarkDown": "Location of docker build configuration path",
			"groupName": "command"
        },
        {
            "name": "tags",
            "type": "multiLine",
            "label": "Tags",
            "defaultValue": "$(Build.BuildNumber)\r\nlatest",
            "required": false,
            "helpMarkDown": "Tags to apply to the built image(s)",
			"groupName": "command"
        },
        {
            "name": "pushAfterBuild",
            "type": "boolean",
            "label": "Push After Build",
            "defaultValue": false,
            "required": true,
            "helpMarkDown": "If selected, will also push the image to your container repository once built",
			"groupName": "command"
        }
	],
    "execution": {
        "Node10": {
            "target": "index.js"
        }
    }
}
