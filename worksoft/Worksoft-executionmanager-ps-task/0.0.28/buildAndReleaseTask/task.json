{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "472B73F0-49A0-4FF3-B4DA-2951343494A6",
  "name": "WorksoftExecutionManager",
  "friendlyName": "Worksoft Execution Manager",
  "description": "Perform automation of Certify Process(es) within Worksoft Execution Manager",
  "helpMarkDown": "",
  "category": "Azure Pipelines",
  "author": "worksoft",
  "version": {
    "Major": 0,
    "Minor": 0,
    "Patch": 21
  },
  "instanceNameFormat": "Execution $(BookmarkName)",
  "inputs": [
    {
      "name":"executiontype",
      "type":"pickList",
      "label":"Execution Type",
      "defaultValue": "bookmark",
      "required": true,
      "options":{
        "bookmark": "Execute a Bookmark",
        "request": "Execute a Pre-Defined Request",
        "processes": "Execute List of Processes"
      },
      "helpMarkDown": "Do you want to execute a Bookmark, run a list of processes, or a pre-defined request within Execution Manager?"
    },
    {
      "name": "bookmarkname",
      "type": "string",
      "label": "Bookmark Name",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Bookmark Name (specified in Management Studio)",
      "visibleRule": "executiontype = bookmark"
    },
    {
      "name": "requestname",
      "type": "string",
      "label": "Pre-Defined Request Name",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Pre-Defined Execution Manager Request Name",
      "visibleRule": "executiontype = request"
    },
    {
      "name": "certifydatabase",
      "type": "string",
      "label": "Certify Database Alias",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Certify database alias name specified in Management Studio",
      "visibleRule": "executiontype = processes"
    },
    {
      "name": "certifyproject",
      "type": "string",
      "label": "Certify Project",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Certify Project Name",
      "visibleRule": "executiontype = processes"
    },
    {
      "name": "processlist",
      "type": "string",
      "label": "Process Name(s)",
      "defaultValue": "[\"folder1\\\\folder1a\\\\process1\",\"folder2\\\\process2\"]",
      "required": true,
      "helpMarkDown": "Process(es) complete with folder paths",
      "visibleRule": "executiontype = processes"
    },
    {
      "name": "email",
      "type": "string",
      "label": "Email Address",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Email Address for authentication in Execution Manager"
    },
    {
      "name": "password",
      "type": "string",
      "label": "Password",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Password for authentication in Execution Manager"
    },
    {
      "name": "executionmanagerhostname",
      "type": "string",
      "label": "Execution Manager Host Name",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Execution Manager Base Url (i.e. https://servername)"
    },
    {
      "name": "resultattributeparameters",
      "type": "string",
      "label": "Result Attribute Values",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Values of result attributes to set for execution"
    },
    {
      "name": "resultfolder",
      "type": "string",
      "label": "Certify Result Folder",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Target Result Folder for execution within Certify"
    }
  ],
  "OutputVariables": [{
    "name":"overallstatus",
    "description":"Overall status as a whole for all Certify Processes executed"
  },
  {
    "name":"overallexecutionstatus",
    "description":"Overall execution status as a whole for all Certify Processes executed"
  },
  {
    "name":"executionjson",
    "description": "Json describing all the details for each Certify Process"
  }],
  "execution": {
    "Node10": {
      "target": "index.js"
    }
  }
}
