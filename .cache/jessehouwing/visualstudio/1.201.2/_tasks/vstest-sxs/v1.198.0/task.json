{
  "description": "Run tests with Visual Studio test runner",
  "minimumAgentVersion": "1.89.0",
  "runsOn": [
    "Agent",
    "DeploymentGroup"
  ],
  "messages": {
    "UpdateOneOrHigherRequired": "Install Visual Studio 2015 Update 1 or higher on your build agent machine to run the tests in parallel.",
    "RunInParallelNotSupported": "Run in Parallel is not supported with testsettings file.",
    "ErrorWhileUpdatingResponseFile": "Error occurred while updating the response file '%s'. All the tests will be executed for this run.",
    "ErrorWhileCreatingResponseFile": "Error occurred while creating the response file. All the tests will be executed for this run.",
    "ErrorWhileListingDiscoveredTests": "Error occured while discovering the tests. All the tests will be exexuted for this run.",
    "VstestReturnCode": "Vstest exited with return code: %d.",
    "VstestFailed": "Vstest failed with error. Check logs for failures. There might be failed tests.",
    "UnexpectedVersionString": "Unexpected version string detected for vstest.console.exe: %s.",
    "ErrorWhilePublishingCodeChanges": "Error occurred while publishing the code changes. All the tests will be executed for this run.",
    "UploadTestResultsPerfTime": "Total time taken to upload test results: %d milliseconds.",
    "FailedToSetRunInParallel": "Failed to set run in parallel. Invalid run settings file.",
    "NoResultsToPublish": "No results found to publish.",
    "VstestNotFound": "Vstest of version %d is not found. Try again with a visual studio version that exists on your build agent machine.",
    "ErrorWhileSettingTestImpactCollectorRunSettings": "Error occurred while setting Test Impact Collector in run settings file.",
    "ErrorReadingVstestVersion": "Error reading the version of vstest.console.exe.",
    "ErrorOccuredWhileSettingRegistry": "Error occured while setting registry key, Error: %s.",
    "VstestDiagNotSupported": "vstest.console.exe version does not support the /diag flag. Enable diagnositics via the exe.config files",
    "VstestTIANotSupported": "Install Visual Studio version 15.0.25807 or higher to run Test Impact Analysis.",
    "ErrorWhileReadingRunSettings": "Error occured while reading run settings file. Error : %s.",
    "PublishCodeChangesPerfTime": "Total time taken to publish code changes: %d milliseconds.",
    "ErrorWhileReadingTestSettings": "Error occured while reading test settings file. Error : %s.",
    "ErrorWhileSettingTestImpactCollectorTestSettings": "Error occurred while setting Test Impact Collector in test settings file.",
    "PathDoesNotExist": "%s path does not exist.",
    "GenerateResponseFilePerfTime": "Total time taken to get response file: %d milliseconds.",
    "UnexpectedVersionNumber": "Unexpected version number detected for vstest.console.exe: %s.",
    "NoMatchingTestAssemblies": "No test assemblies found matching the pattern: %s."
  },
  "author": "Microsoft Corporation",
  "demands": [
    "vstest"
  ],
  "version": {
    "Patch": 0,
    "Minor": 198,
    "Major": 1
  },
  "visibility": [
    "Build",
    "Release"
  ],
  "friendlyName": "Visual Studio Test (Side-by-side)",
  "id": "d962a10a-eaad-5083-bb69-0f4d57094a9a",
  "category": "Test",
  "name": "VSTest-sxs",
  "helpUrl": "https://docs.microsoft.com/azure/devops/pipelines/tasks/test/vstest",
  "inputs": [
    {
      "name": "testAssembly",
      "groupName": "executionOptions",
      "defaultValue": "**\\*test*.dll;-:**\\obj\\**",
      "helpMarkDown": "Test binaries to run tests on.  Wildcards can be used.  For example, `**\\*test*.dll;-:**\\obj\\**` for all dlls with test in name while excluding files in any sub-directory named obj.",
      "required": true,
      "type": "string",
      "label": "Test Assembly"
    },
    {
      "name": "testFiltercriteria",
      "groupName": "executionOptions",
      "defaultValue": "",
      "helpMarkDown": "Additional criteria to filter tests from Test assemblies. For example: `Priority=1|Name=MyTestMethod`",
      "required": false,
      "type": "string",
      "label": "Test Filter criteria"
    },
    {
      "name": "runSettingsFile",
      "groupName": "executionOptions",
      "defaultValue": "",
      "helpMarkDown": "Path to runsettings file to use with the tests. Use `$(Build.SourcesDirectory)` to access the Project folder.",
      "required": false,
      "type": "filePath",
      "label": "Run Settings File"
    },
    {
      "name": "overrideTestrunParameters",
      "groupName": "executionOptions",
      "defaultValue": "",
      "helpMarkDown": "Override parameters defined in the TestRunParameters section of runsettings file. For example: `AppURL=$(DeployURL);Port=8080`",
      "required": false,
      "type": "string",
      "label": "Override TestRun Parameters"
    },
    {
      "name": "codeCoverageEnabled",
      "groupName": "executionOptions",
      "defaultValue": "False",
      "helpMarkDown": "Collect code coverage information from the Test run.",
      "required": false,
      "type": "boolean",
      "label": "Code Coverage Enabled"
    },
    {
      "name": "runInParallel",
      "groupName": "executionOptions",
      "defaultValue": "false",
      "helpMarkDown": "Enable parallel execution of your tests.",
      "required": false,
      "type": "boolean",
      "label": "Run In Parallel"
    },
    {
      "options": {
        "version": "Version",
        "location": "Specify Location"
      },
      "name": "vstestLocationMethod",
      "groupName": "advancedExecutionOptions",
      "defaultValue": "version",
      "required": false,
      "type": "radio",
      "label": "VSTest"
    },
    {
      "visibleRule": "vstestLocationMethod = version",
      "groupName": "advancedExecutionOptions",
      "defaultValue": "14.0",
      "label": "VSTest version",
      "required": false,
      "helpMarkDown": "The version of VSTest to use.",
      "type": "pickList",
      "name": "vsTestVersion",
      "options": {
        "12.0": "Visual Studio 2013",
        "14.0": "Visual Studio 2015",
        "latest": "Latest"
      }
    },
    {
      "visibleRule": "vstestLocationMethod = location",
      "helpMarkDown": "Optionally supply the path to VSTest.",
      "type": "string",
      "groupName": "advancedExecutionOptions",
      "required": false,
      "defaultValue": "",
      "label": "Path to vstest.console.exe",
      "name": "vstestLocation"
    },
    {
      "name": "pathtoCustomTestAdapters",
      "groupName": "advancedExecutionOptions",
      "defaultValue": "",
      "helpMarkDown": "Directory path to custom test adapters. Nuget restored adapters are automatically searched for.",
      "required": false,
      "type": "string",
      "label": "Path to Custom Test Adapters"
    },
    {
      "name": "otherConsoleOptions",
      "groupName": "advancedExecutionOptions",
      "defaultValue": "",
      "helpMarkDown": "Other Console options that can be passed to vstest.console.exe. Click on the help link below for more details.",
      "required": false,
      "type": "string",
      "label": "Other console options"
    },
    {
      "name": "testRunTitle",
      "groupName": "reportingOptions",
      "defaultValue": "",
      "helpMarkDown": "Provide a name for the Test Run.",
      "required": false,
      "type": "string",
      "label": "Test Run Title"
    },
    {
      "name": "platform",
      "groupName": "reportingOptions",
      "defaultValue": "",
      "helpMarkDown": "Platform against which the tests should be reported. If you have defined a variable for platform in your build task, use that here.",
      "required": false,
      "type": "string",
      "label": "Platform"
    },
    {
      "name": "configuration",
      "groupName": "reportingOptions",
      "defaultValue": "",
      "helpMarkDown": "Configuration against which the tests should be reported. If you have defined a variable for configuration in your build task, use that here.",
      "required": false,
      "type": "string",
      "label": "Configuration"
    },
    {
      "name": "publishRunAttachments",
      "groupName": "reportingOptions",
      "defaultValue": "true",
      "helpMarkDown": "Opt in/out of publishing test run level attachments.",
      "required": false,
      "type": "boolean",
      "label": "Upload Test Attachments"
    }
  ],
  "helpMarkDown": "[Learn more about this task](https://go.microsoft.com/fwlink/?LinkId=624539)",
  "instanceNameFormat": "Test Assemblies $(testAssembly)",
  "groups": [
    {
      "displayName": "Execution Options",
      "name": "executionOptions",
      "isExpanded": true
    },
    {
      "displayName": "Advanced Execution Options",
      "name": "advancedExecutionOptions",
      "isExpanded": false
    },
    {
      "displayName": "Reporting Options",
      "name": "reportingOptions",
      "isExpanded": false
    }
  ],
  "execution": {
    "PowerShell": {
      "target": "$(currentDirectory)\\VSTest.ps1",
      "argumentFormat": "",
      "workingDirectory": "$(currentDirectory)",
      "platforms": [
        "windows"
      ]
    }
  }
}
