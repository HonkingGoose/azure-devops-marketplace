{
    "id": "818386e5-c8a5-46c3-822d-954b3c8fb130",
    "name": "FortifySCA",
    "friendlyName": "Fortify Static Code Analyzer Assessment",
    "description": "Run Fortify Static Code Analyzer",
    "helpMarkDown": "",
    "category": "Build",
    "visibility": [
        "Build"
    ],
    "author": "Micro Focus",
    "version": {
        "Major": 1,
        "Minor": 22,
        "Patch": 0
    },
    "demands": [],
    "minimumAgentVersion": "1.83.0",
    "groups": [
        {
            "name":"build",
            "displayName":"Build (translate)",
            "isExpanded":true
        },
        {
            "name":"scan",
            "displayName":"Scan",
            "isExpanded":true
        }
    ],
    "inputs": [
        {
            "name": "licenseFile",
            "type": "string",
            "label": "SCA license file",
            "required": false,
            "helpMarkDown": "If SCA license is specified, it will overwrite the current SCA license on the build agent."
        },
        {
            "name": "runBuildTranslate",
            "type": "boolean",
            "label": "Run Build (translate)",
            "defaultValue": "true",
            "required": true,
            "helpMarkDown": "If checked, will run the Build (translate) step.",
            "groupName":"build"
        },
        {
            "name": "applicationType",
            "type": "pickList",
            "label": "Application Type",
            "defaultValue": "dotnet",
            "required": true,
            "helpMarkDown": "The type of application to be analyzed.",
            "options": {
                "dotnet": ".Net",
                "java": "Java",
                "other": "Other"
            },
            "visibleRule": "runBuildTranslate = true",
            "groupName":"build"
        },
        {
            "name": "fortifyProjects",
            "type": "filePath",
            "label": "Projects for Fortify SCA Analysis",
            "defaultValue": "**\\*.sln",
            "required": true,
            "helpMarkDown": "The relative path to the project or solution to scan with Fortify SCA. Wildcards can be used. For example, `**\\*.sln` for all sln files in all sub folders.",
            "visibleRule": "applicationType = dotnet",
            "groupName":"build"
        },
        {
            "name": "buildClasspath",
            "type": "string",
            "label": "Classpath",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Specifies the path where to look for user classes.",
            "visibleRule": "applicationType = java",
            "groupName":"build"
        },
        {
            "name": "buildSourceVersion",
            "type": "pickList",
            "label": "Source Version",
            "defaultValue": "1.5",
            "options": {
                "1.5":"Java 1.5",
                "1.6":"Java 1.6",
                "1.7":"Java 1.7",
                "1.8":"Java 1.8"
            },
            "required": false,
            "helpMarkDown": "Additional parameters to pass to source analyzer during the translation process.",
            "visibleRule": "applicationType = java",
            "groupName":"build"
        },
        {
            "name": "buildSourcePath",
            "type": "string",
            "label": "Sourcepath",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Specifies the location of source files which will not be included in the scan but will be used for name resolution. Equivalent to the -sourcepath option to javac.",
            "visibleRule": "applicationType = java",
            "groupName":"build"
        },
        {
            "name": "buildAnalyzerParams",
            "type": "string",
            "label": "Additional Build Parameters",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Additional parameters to pass to source analyzer during the translation process.",
            "visibleRule": "runBuildTranslate = true",
            "groupName":"build"
        },
        {
            "name": "buildToolOptions",
            "type": "string",
            "label": "Build Tool Options",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "These options are used when integrating Micro Focus Fortify SCA with a compiler.",
            "visibleRule": "applicationType != dotnet",
            "groupName":"build"
        },
        {
            "name": "fortifySourceTranslate",
            "type": "string",
            "label": "Source File(s) to translate",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Expression denoting a file or a group of files, optionally matching a pattern: file1.java - a file file*.java - files matching expression \"path/**/*.java\" - recursive expression matches.",
            "visibleRule": "applicationType != dotnet",
            "groupName":"build"
        },
        {
            "name": "fortifyOtherTranslate",
            "type": "string",
            "label": "Translation of any other miscellaneous files",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Provide the location of any additional files that SCA should assess with this scan.",
            "visibleRule": "applicationType != dotnet",
            "groupName":"build"
        },
        {
            "name": "fortifyBuildId",
            "type": "string",
            "label": "Build Id for Fortify SCA",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "The build ID is used to track which files are compiled and linked as part of a build and later to scan those files."
        },
        {
            "name": "runFortifyRulepackUpdate",
            "type": "boolean",
            "label": "Run Fortify Rulepack Update",
            "defaultValue": "false",
            "required": true,
            "helpMarkDown": "Compares installed security content to the most current version and updates your installation security content by downloading the latest Micro Focus Fortify Secure Coding Rulepacks and metadata from the Fortify Customer Portal."
        },
        {
            "name": "runFortifyClean",
            "type": "boolean",
            "label": "Run Fortify Clean",
            "defaultValue": "true",
            "required": true,
            "helpMarkDown": "Clears the build ID and all associated intermediate data for that build ID from the previous scan."
        },
        {
            "name": "scaVerbose",
            "type": "boolean",
            "label": "SCA verbose",
            "defaultValue": false,
            "required": true,
            "helpMarkDown": "Run Fortify SCA in verbose mode."
        },
        {
            "name": "scaDebug",
            "type": "boolean",
            "label": "SCA debug",
            "defaultValue": false,
            "required": true,
            "helpMarkDown": "Run Fortify SCA in debug mode."
        },
        {
            "name": "runFortifyScan",
            "type": "boolean",
            "label": "Run Fortify scan",
            "defaultValue": "true",
            "required": true,
            "helpMarkDown": "If checked, will run the Fortify scan step.",
            "groupName":"scan"
        },
        {
            "name": "fortifyScanType",
            "type": "pickList",
            "label": "Scan type",
            "defaultValue": "LocalScan",
            "options": {
                "LocalScan":"Local Scan",
                "CloudScan":"CloudScan"
            },
            "required": "true",
            "helpMarkDown": "To run a scan on your local machine, select Local scan.  To run a scan on distributed machines, select CloudScan.",
            "visibleRule": "runFortifyScan = true",
            "groupName":"scan"
        },
        {
            "name": "additionalScanParams",
            "type": "string",
            "label": "Additional scan parameters",
            "defaultValue": null,
            "required": false,
            "helpMarkDown": "Additional parameters to be used for the scan.",
            "visibleRule": "fortifyScanType = LocalScan",
            "groupName":"scan"
        },
        {
            "name": "customFortifyRulepacks",
            "type": "filePath",
            "label": "Custom Rulepacks",
            "defaultValue": null,
            "required": false,
            "helpMarkDown": "Specifies a custom Rulepack or directory. If you specify a directory, includes all of the files in the directory with the .bin and .xml extensions.",
            "visibleRule": "fortifyScanType = LocalScan",
            "groupName":"scan"
        },
        {
            "name": "runFortifyUpload",
            "type": "boolean",
            "label": "Upload results to SSC",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "When enabled, the SCA result will be transmitted to the application version in SSC that is specified below.",
            "visibleRule": "fortifyScanType = LocalScan",
            "groupName":"scan"
        },
        {
            "name": "fortifyServerName",
            "type": "connectedService:Generic",
            "label": "Fortify SSC server endpoint",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Name of the service endpoint for your VSTS account.",
            "visibleRule": "runFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "fortifyApplicationName",
            "type": "string",
            "label": "SSC application name",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide the Application name in SSC that corresponds to the application being assessed here. Application names in SSC are case sensitive.",
            "visibleRule": "runFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "fortifyApplicationVersion",
            "type": "string",
            "label": "SSC application version",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide the Application version in SSC that corresponds to the application version for this assessment. Application versions in SSC are case sensitive." ,
            "visibleRule": "runFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "uploadProxyURL",
            "type": "string",
            "label": "Proxy URL",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "proxy host and port (ex: proxy.example.com:8080)" ,
            "visibleRule": "runFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "uploadProxyUser",
            "type": "string",
            "label": "Proxy Username",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "" ,
            "visibleRule": "runFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "uploadProxyPass",
            "type": "string",
            "label": "Proxy Password",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "" ,
            "visibleRule": "runFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "cloudScanAdditionalScanParams",
            "type": "string",
            "label": "Additional Scan Parameters",
            "defaultValue": null,
            "required": false,
            "helpMarkDown": "Additional parameters to be used for the scan.",
            "visibleRule": "fortifyScanType = CloudScan",
            "groupName":"scan"
        },
        {
            "name": "cloudScanCustomFortifyRulepacks",
            "type": "filePath",
            "label": "Custom Rulepacks",
            "defaultValue": null,
            "required": false,
            "helpMarkDown": "Specifies a custom Rulepack or directory. If you specify a directory, includes all of the files in the directory with the .bin and .xml extensions.",
            "visibleRule": "fortifyScanType = CloudScan",
            "groupName":"scan"
        },
        {
            "name": "cloudScanfortifyServerName",
            "type": "connectedService:Generic",
            "label": "Fortify SSC server endpoint",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Name of the service endpoint for your VSTS account.",
            "visibleRule": "fortifyScanType = CloudScan",
            "groupName":"scan"
        },
        {
            "name": "cloudScanRunFortifyUpload",
            "type": "boolean",
            "label": "Upload results to SSC",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Select this check box to enable the upload of scan results to the application version in Fortify Software Security Center.",
            "visibleRule": "fortifyScanType = CloudScan",
            "groupName":"scan"
        },
        {
            "name": "cloudScanFortifyApplicationName",
            "type": "string",
            "label": "SSC application name",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide the Application name in SSC that corresponds to the application being assessed here. Application names in SSC are case sensitive.",
            "visibleRule": "cloudScanRunFortifyUpload = true",
            "groupName":"scan"
        },
        {
            "name": "cloudScanFortifyApplicationVersion",
            "type": "string",
            "label": "SSC application version",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide the Application version in SSC that corresponds to the application version for this assessment. Application versions in SSC are case sensitive." ,
            "visibleRule": "cloudScanRunFortifyUpload = true",
            "groupName":"scan"
        }
    ],
    "instanceNameFormat": "Run Fortify on $(FortifyProjects)",
    "execution": {
        "Node": {
            "target": "Fortify.js",
            "argumentFormat": "",
            "workingDirectory": "$(currentDirectory)"
        }
    },
    "messages":{
        "conditionalFieldRequirement": "%s is required for %s",
        "password":"Password/Token",
        "version.failure":"You must have Fortify Static Code Analyzer version 16.11 or later installed. It may also be necessary to restart the agent from a new command-window or restart the agent service so any changes to executable PATH environment are visible to the agent."
    }
}
