{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "FB692F50-03A7-44CF-9110-2A943AFEB976",
  "name": "InstallMSITask",
  "friendlyName": "Install MSI",
  "description": "Installs an msi on the local machine",
  "helpMarkDown": "",
  "category": "Deploy",
  "visibility": [
    "Release"
  ],
  "runsOn": [
    "Agent",
    "MachineGroup"
  ],
  "demands": [],
  "author": "POFerro",
  "version": {
    "Major": 0,
    "Minor": 1,
    "Patch": 4
  },
  "instanceNameFormat": "Install $(msiFileName)",
  "groups": [
    {
      "name": "advanced",
      "displayName": "Advanced",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "msiFileName",
      "type": "string",
      "label": "MSI File Name",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Name of the MSI file to install (ex: MyProductInstaller.msi)"
    },
    {
      "name": "msiProperties",
      "type": "string",
      "label": "MSI Properties",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "MSI properties sent as command line (ex: INSTALLFOLDER=\"c:\\Program Files\\MyProduct\" MYPROPERTY=value)"
    },
    {
      "name": "logFilePath",
      "type": "filePath",
      "label": "Log File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Log file to be written by installation (ex: \"c:\\logs\\msi.log\")",
      "groupName": "advanced"
    },
    {
      "name": "logLevel",
      "type": "pickList",
      "label": "Log Level",
      "defaultValue": "0x00",
      "required": false,
      "options": {
        "0x00": "None",
        "0x01": "Error",
        "0x02": "Warning",
        "0x04": "Info",
        "0x0c": "Verbose",
        "0x0d": "ExtraDebug"
      },
      "helpMarkDown": "Detail level of written log file",
      "groupName": "advanced"
    }


  ],
  "execution": {
    "PowerShell3": {
      "target": "installmsi.ps1",
      "platforms": [
        "windows"
      ],
      "workingDirectory": "$(currentDirectory)"
    }
  }
}